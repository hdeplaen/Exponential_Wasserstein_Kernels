function varargout = eval_mlssvmP_cpu(varargin)
%Evaluates a multi-class LSSVM (primal with feature maps)
%
%labels = EVAL_MULTI_LSSVM(model, V)
%
%INPUT
%   model:  LSSVM multi-class model (generated by compute_multi_lssvm.m)
%   V:      feature vectors (n*dim)
%
%OUTPUT
%   labels: evaluated labels
%
%Author: HENRI DE PLAEN
%Date: March 2019
%Copyright: KU Leuven

%% PRELIMINARIES
assert(nargin==2,  'Wrong number of uinput arguments') ;
assert(nargout==1, 'Wrong number of output arguments') ;

model = varargin{1} ;
W = model.W ;
bT = model.bT ;
V = varargin{2} ;

clear varargin 

nv = size(V,1) ;

%% EVALUATE
Y = V*W + repmat(bT,nv,1) ;

%% OUTPUT
varargout{1} = sign(Y) ;

end

